#!/bin/bash

# runfcl - Execute jobs from FCL templates
# Wrapper for runfcl.py

# Get the directory where this script is located
SCRIPT_DIR="$(dirname "$(readlink -f "${BASH_SOURCE[0]}")")"

# Check for --setup argument and consume it (don't pass to Python script)
SETUP_SCRIPT=""
ARGS=()
while [[ $# -gt 0 ]]; do
    case $1 in
        --setup)
            SETUP_SCRIPT="$2"
            shift 2  # Skip both --setup and its value
            ;;
        *)
            ARGS+=("$1")
            shift
            ;;
    esac
done

# Use default Mu2e environment setup
source /cvmfs/mu2e.opensciencegrid.org/setupmu2e-art.sh
muse setup ops
source $SETUP_SCRIPT
setup OfflineOps

# Run the Python script with remaining arguments
exec python3 "$SCRIPT_DIR/../utils/runfcl.py" "${ARGS[@]}"
